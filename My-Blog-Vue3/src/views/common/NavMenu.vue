<template>
  <!-- å¸¸è§„å¤´éƒ¨å¯¼èˆªåˆ—è¡¨ -->
  <template v-if="!isMobile">
    <div class="center-toolbar screen-none">
      <ul class="scroll-menu">
        <!-- æ–‡ç«  -->
        <li>
          <el-popover
            transition="el-zoom-in-center"
            :hide-after="300"
            popper-class="mk-popper"
            placement="bottom"
            trigger="hover"
          >
            <div class="mk-popover_item myBetween">
              <!-- åˆ†ç±» -->
              <li @click="$router.push({ path: '/sort' })">
                <img src="../../assets/svg/sort.svg" />
                åˆ†ç±»
              </li>
              <!-- æ ‡ç­¾ -->
              <li
                @click="$router.push({ path: '/tags', query: { labelId: 25 } })"
              >
                <img src="../../assets/svg/tag.svg" />
                æ ‡ç­¾
              </li>
            </div>
            <template #reference>
              <span class="menu-item-link">
                <img src="../../assets/svg/document.svg" />
                æ–‡ç« 
              </span>
            </template>
          </el-popover>
        </li>
        <!-- ç©ºé—´ -->
        <li>
          <el-popover
            transition="el-zoom-in-center"
            :hide-after="300"
            popper-class="mk-popper"
            placement="bottom"
            trigger="hover"
          >
            <div class="mk-popover_item myBetween">
              <!-- éŸ³ä¹ -->
              <li @click="$router.push({ path: '/funny' })">
                <img src="../../assets/svg/music.svg" />
                å¹»éŸ³åŠ
              </li>
              <!-- è—å®é˜ -->
              <li @click="$router.push({ path: '/tools' })">
                <img src="../../assets/svg/treasure.svg" />
                è—å®é˜
              </li>
            </div>
            <template #reference>
              <span class="menu-item-link">
                <img src="../../assets/svg/space.svg" />
                ç©ºé—´
              </span>
            </template>
          </el-popover>
        </li>
        <!-- æˆ‘çš„ -->
        <li>
          <el-popover
            transition="el-zoom-in-center"
            :hide-after="300"
            popper-class="mk-popper"
            placement="bottom"
            trigger="hover"
          >
            <div class="mk-popover_item myBetween">
              <!-- ç›¸å†Œ -->
              <li @click="$router.push({ path: '/travel' })">
                ğŸ“¸ <span>ç›¸å†Œ</span>
              </li>
              <!-- çˆ±é“¾ -->
              <li @click="$router.push({ path: '/love' })">
                <img src="../../assets/svg/love.svg" />
                çˆ±é“¾
              </li>
              <!-- å°æ¸¸æˆ -->
              <li @click="emit('openPcGame')">ğŸ® <span>å°æ¸¸æˆ</span></li>
              <!-- ç¼–è¾‘æ€ª -->
              <li @click="emit('edit')">
                <img src="../../assets/svg/pencil.svg" />
                ç¼–è¾‘æ€ª
              </li>
              <!-- å…³äº -->
              <li @click="$router.push({ path: '/about' })">
                ğŸ· <span>å…³äºæˆ‘</span>
              </li>
            </div>
            <template #reference>
              <span class="menu-item-link">
                <img src="../../assets/svg/home.svg" />
                æˆ‘çš„
              </span>
            </template>
          </el-popover>
        </li>
        <!-- ç¤¾äº¤ -->
        <li>
          <el-popover
            transition="el-zoom-in-center"
            :hide-after="300"
            popper-class="mk-popper"
            placement="bottom"
            trigger="hover"
          >
            <div class="mk-popover_item myBetween">
              <!-- ç•™è¨€å… -->
              <li @click="$router.push({ path: '/message' })">
                âœğŸ» <span>ç•™è¨€å…</span>
              </li>
              <!-- å‹é“¾ -->
              <li @click="$router.push({ path: '/friend' })">
                ğŸ€ <span>å‹é“¾</span>
              </li>
            </div>
            <template #reference>
              <span class="menu-item-link">
                <img src="../../assets/svg/socialContact.svg" />
                ç¤¾äº¤
              </span>
            </template>
          </el-popover>
        </li>
      </ul>
    </div>
    <div class="center-toolbar">
      <ul class="scroll-menu">
        <!-- éšæœºæ–‡ç«  -->
        <li
          class="menu-tool-item"
          title="éšä¾¿çœ‹çœ‹-éšæœºè®¿é—®ä¸€ç¯‡æœ¬ç«™æ–‡ç« "
          @click="emit('openRandomArticle')"
        >
          <div class="icon-container"><i class="fa fa-grav"></i></div>
        </li>
        <!-- åˆ‡æ¢èƒŒæ™¯ -->
        <li
          class="menu-tool-item"
          title="åˆ‡æ¢èƒŒæ™¯-æ¢ä¸€ç§èƒŒæ™¯ï¼Œæ¢ä¸€ç§æ„Ÿè§‰ã€‚"
          id="changeThemeRef"
          @click="emit('openChangeBg')"
        >
          <div class="icon-container"><i class="fa fa-image"></i></div>
        </li>
        <!-- å…³é—­æ¨±èŠ± -->
        <li class="menu-tool-item" @click="emit('handleSakura')">
          <div class="icon-container">
            <i class="fa fa-pagelines"></i>
          </div>
        </li>
        <!-- å…³ç¯ -->
        <li class="menu-tool-item icon-container change-color-icon">
          <switchBtn id="changeColorRef" @click="emit('changeColor')" />
        </li>
        <!-- ä¸ªäººä¸­å¿ƒ -->
        <li class="user-center">
          <el-dropdown placement="bottom" popper-class="user-center-dropdown">
            <el-avatar
              class="user-avatar"
              :size="36"
              :src="currentUser.avatar ? currentUser.avatar : webInfo.avatar"
            />
            <template #dropdown>
              <el-dropdown-menu>
                <el-dropdown-item
                  @click="$router.push({ path: '/user' })"
                  v-if="!$common.isEmpty(currentUser)"
                  class="user"
                >
                  <i class="fa fa-user-circle" aria-hidden="true"></i>
                  <span>ä¸ªäºº</span>
                </el-dropdown-item>
                <el-dropdown-item
                  @click="emit('logout')"
                  v-if="!$common.isEmpty(currentUser)"
                  class="logout"
                >
                  <i class="fa fa-sign-out" aria-hidden="true"></i>
                  <span>é€€å‡º</span>
                </el-dropdown-item>
                <el-dropdown-item
                  @click="$router.push({ path: '/user' })"
                  v-if="$common.isEmpty(currentUser)"
                  class="login"
                >
                  <i class="fa fa-sign-in" aria-hidden="true"></i>
                  <span>ç™»å½•</span>
                </el-dropdown-item>
              </el-dropdown-menu>
            </template>
          </el-dropdown>
        </li>
      </ul>
    </div>
  </template>
</template>

<script setup>
import { defineAsyncComponent, computed } from "vue";
import { useStore } from "@/stores";

const store = useStore();

const currentUser = computed(() => store.currentUser);
const webInfo = computed(() => store.webInfo);

const switchBtn = defineAsyncComponent(() => import("./switchBtn.vue"));

defineProps({
  isMobile: {
    type: Boolean,
    default: false,
  },
});

const emit = defineEmits([
  "openPcGame",
  "edit",
  "openRandomArticle",
  "openChangeBg",
  "handleSakura",
  "changeColor",
  "logout",
]);
</script>

<style lang="scss" scoped>
.center-toolbar {
  .scroll-menu {
    color: var(--red1);
    display: flex;
    justify-content: flex-end;
    padding: 0;

    > li {
      list-style: none;
      margin-right: 24px;
      font-size: 17px;
      height: 50px;
      line-height: 50px;
      position: relative;
      text-decoration: none;
      background: var(--gradientAnimation);
      background-size: 0px 3px;
      transition: background-size 800ms;

      .menu-item-link {
        display: flex;
        align-items: center;
    
        img {
          vertical-align: -3px;
        }
      }

      &.menu-tool-item {
        color: var(--fontColor);
        font-size: 20px;

        &.change-color-icon {
          transform: scale(0.16);
          width: 70px;
          height: 0;
        }
      }

      &:hover {
        color: var(--orange2);
        background-position-x: left;
        background-size: 100% 3px;
      }

      &:last-child {
        margin-right: 0;
        display: flex;
        align-items: center;
      }
    }
  }
}

// åª’ä½“æŸ¥è¯¢
@media screen and (max-width: 950px) {
  .screen-none {
    display: none;
  }
}
</style>

<style lang="scss">
// é¡¶éƒ¨å·¥å…·æ ä¸‹æ‹‰å†…å®¹
.mk-popper {
  .mk-popover_item {
    li {
      list-style: none;
      padding: 8px;
      font-size: 16px;
      color: var(--red);

      img {
        vertical-align: -3px;
      }

      &:hover {
        background: var(--red);
        color: var(--white);
        padding: 8px;
        border-radius: 100px;
        animation: slide-top 0.5s ease-in-out both;
      }
    }
  }
}

.user-center-dropdown {
  font-size: unset !important;
  color: unset !important;
  background: unset !important;
  padding: unset !important;

  .el-dropdown-menu {
    align-items: center;
    border-radius: 13px;
    padding: 6px;
    border: 0;
    background: var(--blue);

    .el-dropdown-menu__item {
      font-size: unset;
      line-height: 26px;
      padding: 10px;
      color: var(--red);

      &:hover {
        border-radius: 8px;
        animation: slide-top 0.5s ease-in-out both;
        background-color: var(--red);
        color: var(--white);
      }

      &.user,
      &.login,
      &.logout {
        &:hover {
          color: var(--white);
        }
      }
    }

    &.active {
      display: flex;
    }
  }
}
</style>
